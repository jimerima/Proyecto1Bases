{% extends "base.html" %}

{% block titulo %}Consultar lecturas por persona{% endblock %}

{% block contenido %}
  <div class="hero" style="text-align:center; padding-top: 2rem;">
    <div class="col" style="margin:auto; max-width:920px; text-align:left;">
      <div class="eyebrow" style="font-weight: bold; color:#000;">Consultas</div>
      <h1>Consultar lecturas por persona</h1>
      <p class="lead" style="text-align:center; font-size:1.05rem; margin-bottom:1.25rem; color:#000;">
        Selecciona a la persona a <strong>consultar</strong>.
      </p>

      <form action="{{ url_for('vista_consultar_lecturas') }}" method="post" style="margin-top:1rem;">

        <!-- Persona (select dentro de form-control) -->
        <div class="form-group" style="margin-bottom:1.25rem;">
          <label for="persona_id" style="font-weight:600; margin-bottom:.5rem; color:#000;">Selecciona una persona</label>
          <select name="persona_id" id="persona_id" class="form-control"
                  style="width:100%; padding:.8rem; font-size:1rem; border-radius:8px; border:1px solid #ccc;">
            <option value="" disabled selected>Selecciona una persona</option>
            {% if personas.items is defined %}
              {% for id, p in personas.items() %}
                <option value="{{ id }}">{{ id }} ‚Äî {{ p.nombre }}</option>
              {% endfor %}
            {% else %}
              {% for p in personas %}
                <option value="{{ p.id }}">{{ p.id }} ‚Äî {{ p.nombre }}</option>
              {% endfor %}
            {% endif %}
          </select>
          <small style="display:block; margin-top:.4rem; color:#000;">
            Solo puedes seleccionar del listado.
          </small>
        </div>

        <!-- Acciones -->
        <div class="actions" style="display:flex; justify-content:flex-end; gap:.8rem; margin-top:1.1rem;">
          <a class="btn btn--secondary" href="{{ url_for('vista_consultas') }}"
             style="text-decoration:none; background:#e0e0e0; color:#000;">‚¨Ö Volver</a>
          <button class="btn btn--primary" type="submit"
                  style="padding:.8rem 1.6rem; font-size:1rem; border-radius:10px;">üîç Consultar</button>
        </div>
      </form>

      {% if libros is defined %}
        <div class="divider" style="margin:1.4rem 0;"></div>
        <h2>Resultados</h2>

        {% if libros %}
          <div style="overflow:auto; border:1px solid #ddd; border-radius:10px; background:#fff;">
            <table style="width:100%; border-collapse:collapse;">
              <thead>
                <tr>
                  <th style="text-align:left; padding:.7rem; border-bottom:1px solid #eee;">T√≠tulo</th>
                  <th style="text-align:left; padding:.7rem; border-bottom:1px solid #eee;">G√©nero</th>
                  <th style="text-align:left; padding:.7rem; border-bottom:1px solid #eee;">A√±o</th>
                </tr>
              </thead>
              <tbody>
                {% for libro in libros %}
                  <tr>
                    <td style="padding:.65rem; border-bottom:1px solid #f3f3f3;">
                      {{ libro.titulo or libro.Titulo }}
                    </td>
                    <td style="padding:.65rem; border-bottom:1px solid #f3f3f3;">
                      {{ libro.genero or libro.Genero }}
                    </td>
                    <td style="padding:.65rem; border-bottom:1px solid #f3f3f3;">
                      {{ libro.anno or libro.Anno }}
                    </td>
                  </tr>
                {% endfor %}
              </tbody>
            </table>
          </div>
        {% else %}
          <p style="margin-top:.75rem; color:#000;">No se encontraron lecturas para esa persona.</p>
        {% endif %}
      {% endif %}
    </div>
  </div>

{% endblock %}
